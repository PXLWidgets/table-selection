/*! For license information please see table-selection.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TableSelection=t():e.TableSelection=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>l});var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,l=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(o)throw o.error}}return a},o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,l=t.length;o<l;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};const l=function(){function e(e){var t=this;void 0===e&&(e={}),this.config={selector:".table-selection",selectionCssMode:"style",selectionCssClass:"selected"},this.range=null,this.config=n(n({},this.config),e);var r=document.createElement("style");r.innerHTML="".concat(this.config.selector," *::selection {\n            background: transparent;\n            color: inherit;\n        }"),document.head.appendChild(r),document.addEventListener("selectionchange",(function(){return t.onSelectionChange()})),document.addEventListener("copy",(function(e){return t.copyToClipboard(e)}))}return e.prototype.onSelectionChange=function(){var e=getSelection();if(this.deselect(),e&&!e.isCollapsed){var t=this.getCellElementFromNode(e.anchorNode),n=this.getCellElementFromNode(e.focusNode);if(t&&n){var r=this.getTableElementsFromCellElement(t),o=this.getTableElementsFromCellElement(n);r&&o&&r.table===o.table&&(this.elements=r,this.getRangeByStartAndEndElement(t,n),this.getRowElements(),this.getRowsAndCells(),this.range?this.select():this.deselect())}}},e.prototype.getRangeByStartAndEndElement=function(e,t){var n,o,l=e.parentElement,a=t.parentElement;l&&a&&(this.range={start:{row:l.rowIndex+1,cell:e.cellIndex+1},end:{row:a.rowIndex+1,cell:t.cellIndex+1},rowElements:[],rows:[],cells:[]},this.range.start.cell>this.range.end.cell&&(n=r([this.range.end.cell,this.range.start.cell],2),this.range.start.cell=n[0],this.range.end.cell=n[1]),this.range.start.row>this.range.end.row&&(o=r([this.range.end.row,this.range.start.row],2),this.range.start.row=o[0],this.range.end.row=o[1]))},e.prototype.getRowElements=function(){if(this.range&&this.elements.table){var e=this.elements.table.querySelectorAll("thead tr").length,t=[],n=[],l=this.range.start.row<=e?Math.min(e,this.range.start.row):null,a=this.range.start.row<=e?Math.min(e,this.range.end.row):null,s=this.range.end.row>e?Math.max(1,this.range.start.row-e):null,i=this.range.end.row>e?Math.max(1,this.range.end.row-e):null;l&&(t=Array.from(this.elements.table.querySelectorAll("thead tr:nth-of-type(n+".concat(l,"):nth-of-type(-n+").concat(a,")")))),s&&(n=Array.from(this.elements.table.querySelectorAll("tbody tr:nth-of-type(n+".concat(s,"):nth-of-type(-n+").concat(i,")")))),this.range.rowElements=o(o([],r(t),!1),r(n),!1)}},e.prototype.getRowsAndCells=function(){var e=this;if(this.range&&this.range.rowElements){var t=[];this.range.rowElements.forEach((function(n,l){if(e.range){var a=Array.from(n.querySelectorAll(["td:nth-of-type(n+".concat(e.range.start.cell,"):nth-of-type(-n+").concat(e.range.end.cell,")"),"th:nth-of-type(n+".concat(e.range.start.cell,"):nth-of-type(-n+").concat(e.range.end.cell,")")].join(",")));t=o(o([],r(t),!1),r(a),!1),e.range.rows[l]=a}})),this.range.cells=t}},e.prototype.getCellElementFromNode=function(e){if(!e)return null;var t="#text"===e.nodeName?e.parentElement:e;return t&&["TD","TH"].includes(t.tagName)?t:null},e.prototype.getTableElementsFromCellElement=function(e){if(!e||!e.parentElement||!e.parentElement.parentElement)return null;var t=e.parentElement.parentElement,n=["TBODY","THEAD"].includes(t.tagName)?t.parentElement:t;return n&&this.config.selector&&n.matches(this.config.selector)?{table:n,thead:n.querySelector("thead"),tbody:n.querySelector("tbody")}:null},e.prototype.select=function(){var e=this;this.range&&this.range.cells&&this.range.cells.forEach((function(t){"cssClass"===e.config.selectionCssMode&&e.config.selectionCssClass?t.classList.add(e.config.selectionCssClass):(t.style.backgroundColor="var(--table-selection-background-color, Highlight)",t.style.color="var(--table-selection-color, HighlightText)")}))},e.prototype.deselect=function(){var e=this;this.range&&this.range.cells&&(this.range.cells.forEach((function(t){"cssClass"===e.config.selectionCssMode&&e.config.selectionCssClass?t.classList.remove(e.config.selectionCssClass):(t.style.removeProperty("background-color"),t.style.removeProperty("color"))})),this.range=null)},e.prototype.copyToClipboard=function(e){if(this.range&&this.range.rows&&e.clipboardData){var t=this.range.rows.map((function(e){return e.map((function(e){return e.innerText})).join("\t")})).join("\r\n");t&&(e.clipboardData.setData("text/plain",t),e.preventDefault())}},e}();return t.default})()}));
//# sourceMappingURL=table-selection.min.js.map